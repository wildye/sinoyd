<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./static/master.css">
</head>
<body>
    <ul class="nav-top"></ul>

<script src="../lib/jquery-1.12.4.js"></script>
<script>
    
    (function(path){
        readJson(path, data => {
            $('.nav-top').html(createTree(data, ''));
        })
    })('./menu.json')

    function createTree (list, str) {
        list.forEach(function(val) {
            if (val.subset) {
                str += '<li class="more"><a href="' + val.link + '">' + val.title + '</a><ul>' + createTree(val.subset, '') + '</ul></li>';
            } else {
                str += '<li><a href="' + val.link + '">' + val.title + '</a></li>';
            }
        });
        return str;
    }

    // 读取 json 文件
    function readJson (filePath, callback) {
      let promise = new Promise(function(success, failure) {
        $.get(filePath, function(result) {
          success(result);
        }, "json");
      });
      promise.then(function(result) {
        callback(result)
      }, function (error) {
        console.log(error)
      })
    }
</script>
</body>
</html>